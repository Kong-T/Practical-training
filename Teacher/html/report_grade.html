<html>

<head>
  <meta charset="utf-8">
  <title>Bootstrap 布局实例</title>
  <link type="text/css" href="../css/report_grade.css">
  <link type="text/css" href="../../Student/css/StuNav.css">
  
  <link href="../css/blog.css" rel="stylesheet">
  <link href="../../assets4.5/dist/css/bootstrap.css" rel="stylesheet">

  <link href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>
  <script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <!-- <script src="D:\Practical-training\Teacher\JS\guide_grade.js"></script> -->
  <script type="text/javascript">
    window.onload = function () {
      var name = "report_grade";
      $.ajax({
        url: "http://localhost:8080/TReportGrade",
        type: "post",
        data: name, 
        success: function (data) {
          /*这个方法里是ajax发送请求成功之后执行的代码*/
          //console.log(data);
          window.data = data;
          console.log(data)
          window.length  =data.R_team.length;//获取一个全局变量 用于表示小组数量
          console.log(window.length);
          showData(data);//我们仅做数据展示
        },
        error: function (msg) {
          alert("ajax连接异常：" + msg);
          console.log("error");
        }
      })
      function showData(data) {
        console.log("showdata调用全局变量"+window.length);
        console.log("showdata中的"+data);
        var str = "";//定义用于拼接的字符串
        for (var i = 0; i < window.length; i++) {
          var time ="time"+i;
          var place = "place" +i;
          var team = "team"+i;
          var grade ="gradeID"+i
          // str += "<tr><td>" + data[i] + "</td><td><input type=\"text\"  id=" +gradeid +" placeholder = \"请输入分数\"></td></tr>"
          str += "<tr><td><div id = " + time + ">" + data.R_team[i] + "</div></td><td><div id = " + place + ">" + data.R_place[i] + "</div><td><div id = " + team + ">" + data.R_team[i] + "</div></td><td><input type=\"text\""+" "+"id="+"\""+grade+"\""+" "+"placeholder=\"请输入分数\"></td></tr>"
          console.log(str);
        }
        $("#table1").html(str);

      }
    }
  </script>

  <script>
    function replyGraderelease() {
       // 第三种数组的定义
       var grade={
          "teamid":new Array(),
          "grade":new Array()
        };
       
      var str0 = new Array();
      var teamID = new Array();

      for (var i = 0; i <window.length; i++) {
        str0[i] = "gradeID" + i;                    //成绩id
        teamID[i] = "team"+i;   //小组ID

        // 第三种
        grade.teamid[i]=document.getElementById(teamID[i]).innerText;
        grade.grade[i]=document.getElementById(str0[i]).value;
      }
      console.log("grade"+grade.teamid);
   
      $.ajax({
        type: "POST",
        url: "http://localhost:8080/TReportGrade_1",
        data: JSON.stringify(grade),
        dataType: "JSON",
        contentType: "application/json",
        async: 'true',
        success: function (data) {
          if (data.msg == true) {
            alert("答辩成绩上传成功");
          }
        },
        error: function () {
          //请求出错处理
          console.log("答辩成绩上传失败");

        },

      })

    }
  </Script>

</head>

<body>
  <header class="blog-header py-3">
    <div class="row flex-nowrap justify-content-between align-items-center">
      <!-- <div class="col-4 pt-1">
        <a class="text-muted" href="#">实训</a>
      </div> -->
      <div class="col-4">
        <a class="blog-header-logo text-dark">实训</a>
      </div>
      <div class="col-4 d-flex justify-content-end align-items-center">
        <a class="text-muted" href="#" aria-label="Search">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="currentColor"
            stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="mx-3" role="img"
            viewBox="0 0 24 24" focusable="false">
            <title>Search</title>
            <circle cx="10.5" cy="10.5" r="7.5" />
            <path d="M21 21l-5.2-5.2" />
          </svg>
        </a>
        <a class="btn btn-sm btn-outline-secondary" href="T_center.html">我的</a>
      </div>
    </div>
  </header>

  <div class="nav-scroller py-1 mb-2">
    <nav class="nav d-flex justify-content-between">
      <a class="p-2 text-muted" href="Tnotice.html">通知公告</a>
      <a class="p-2 text-muted" href="TBord.html">留言板</a>
      <a class="p-2 text-muted" href="#">课程资源</a>
      <a class="p-2 text-muted" href="report_grade.html">答辩成绩</a>
      <a class="p-2 text-muted" href="guide_grade.html">指导成绩</a>

      <a class="p-2 text-muted" href="topicRelease.html">填报选题</a>
      <!-- <a class="p-2 text-muted" href="#">Business</a>
      <a class="p-2 text-muted" href="#">Politics</a>
      <a class="p-2 text-muted" href="#">Opinion</a>
      <a class="p-2 text-muted" href="#">Science</a>
      <a class="p-2 text-muted" href="#">Health</a>
      <a class="p-2 text-muted" href="#">Style</a>
      <a class="p-2 text-muted" href="#">Travel</a> -->
    </nav>
  </div>
  <div class="container">
    <table class="table table-striped">
      <thead>
        <tr>
          <th style="text-align: center;">答辩时间</th>
          <th style="text-align: center;">答辩场地</th>
          <th style="text-align: center;">答辩小组</th>
          <th style="text-align: center;">答辩评分</th>
        </tr>
      </thead>
      <tbody id="table1">
        <tr>
    
        </tr>
      </tbody>
    </table>
    <button onclick = "replyGraderelease()">确定</button>
  </div>

</body>
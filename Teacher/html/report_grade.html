<html>

<head>
  <meta charset="utf-8">
  <title>Bootstrap 布局实例</title>
  <link type="text/css" href="../css/report_grade.css">
  <link type="text/css" href="../../Student/css/StuNav.css">
  <link href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>
  <script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <!-- <script src="D:\Practical-training\Teacher\JS\guide_grade.js"></script> -->
  <script type="text/javascript">
    window.onload = function () {
      var name = "report_grade";
      $.ajax({
        url: "http://localhost:8080/TReportGrade",
        type: "post",
        data: name, 
        success: function (data) {
          /*这个方法里是ajax发送请求成功之后执行的代码*/
          //console.log(data);
          window.data = data;
          console.log(data)
          window.length  =data.R_team.length;//获取一个全局变量 用于表示小组数量
          console.log(window.length);
          showData(data);//我们仅做数据展示
        },
        error: function (msg) {
          alert("ajax连接异常：" + msg);
          console.log("error");
        }
      })
      function showData(data) {
        console.log("showdata调用全局变量"+window.length);
        console.log("showdata中的"+data);
        var str = "";//定义用于拼接的字符串
        for (var i = 0; i < window.length; i++) {
          var time ="time"+i;
          var place = "place" +i;
          var team = "team"+i;
          var grade ="gradeID"+i
          // str += "<tr><td>" + data[i] + "</td><td><input type=\"text\"  id=" +gradeid +" placeholder = \"请输入分数\"></td></tr>"
          str += "<tr><td><div id = " + time + ">" + data.R_team[i] + "</div></td><td><div id = " + place + ">" + data.R_place[i] + "</div><td><div id = " + team + ">" + data.R_team[i] + "</div></td><td><input type=\"text\""+" "+"id="+"\""+grade+"\""+" "+"placeholder=\"请输入分数\"></td></tr>"
          console.log(str);
        }
        $("#table1").html(str);

      }
    }
  </script>

  <script>
    function replyGraderelease() {
       // 第三种数组的定义
       var grade={
          "teamid":new Array(),
          "grade":new Array()
        };
       
      var str0 = new Array();
      var teamID = new Array();

      for (var i = 0; i <window.length; i++) {
        str0[i] = "gradeID" + i;                    //成绩id
        teamID[i] = "team"+i;   //小组ID

        // 第三种
        grade.teamid[i]=document.getElementById(teamID[i]).innerText;
        grade.grade[i]=document.getElementById(str0[i]).value;
      }
      console.log("grade"+grade.teamid);
   
      $.ajax({
        type: "POST",
        url: "http://localhost:8080/TReportGrade_1",
        data: JSON.stringify(grade),
        dataType: "JSON",
        contentType: "application/json",
        async: 'true',
        success: function (data) {
          if (data.msg == true) {
            alert("答辩成绩上传成功");
          }
        },
        error: function () {
          //请求出错处理
          console.log("答辩成绩上传失败");

        },

      })

    }
  </Script>

</head>

<body>
  <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container-fluid">
      <div class="collapse navbar-collapse" id="example-navbar-collapse">
        <ul class="nav navbar-nav">
          <li><a class="icon-bar" href="#">方正实训</a>
          </li>
          <li><a href="Tnotice.html">通知公告</a>
          </li>
          <li><a href="TBord.html">留言板</a>
          </li>
          <li><a href="topicRelease.html">发布题目</a>
          </li>
          <li><a href="guide_grade.html"  onclick="javascript:requestData()">录入指导成绩</a>
          </li>
          <li class="active"><a href="report_grade.html">答辩打分</a>
          </li>
        </ul>
        <ul class="nav navbar-nav navbar-right">
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="..\usercenter\html\teacherCenter.html" id="navbarDropdown"
              role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">我的</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>
  <div class="container">
    <table class="table table-striped">
      <thead>
        <tr>
          <th style="text-align: center;">答辩时间</th>
          <th style="text-align: center;">答辩场地</th>
          <th style="text-align: center;">答辩小组</th>
          <th style="text-align: center;">答辩评分</th>
        </tr>
      </thead>
      <tbody id="table1">
        <tr>
    
        </tr>
      </tbody>
    </table>
    <button onclick = "replyGraderelease()">确定</button>
  </div>

</body>
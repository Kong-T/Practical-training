<html>

<head>
    <meta charset="utf-8">
    <title>教师发布题目</title>
    <link rel="stylesheet" type="text/css" href="..\css\topic_admin.css">
    <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.css">
    <script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>
<script type="text/javascript">
    window.onload = function () {
        // 请求后端数据
        $.ajax({
            url: "http://localhost:8080/Ad_topic",
            type: "post",
            data: name,
            success: function (data) {
                showData(data);//我们仅做数据展示
            },
            error: function (msg) {
                alert("ajax连接异常：" + msg);
                console.log("error");
            }
        })

        // 展示数据
        function showData(data) {
            var str = "";//定义用于拼接的字符串
            // console.log(data);
            for (var i = 0; i < data.Topic_title.length; i++) {
                
            console.log(data.Topic_title);
            
                for (var i in data.Topic_title) {
                    var Topic_titleID = " Topic_title" + i;
                    var Topic_detailsID = "Topic_details" + i;
                    var TutorID = "Tutor" + i;
                    var denyID = "deny" +i;
                    str += "<tr><td id=\""+Topic_titleID+"\">" + data.Topic_title[i] + "</td><td id=\""+Topic_detailsID+"\">" + data.Topic_details[i] + "</td><td id=\""+TutorID+"\">" + data.Tutor[i] + "</td><td><input type=\"checkbox\">是<input type =\"checkbox\" name=\"deny\" id=\""+denyID +  "\"style = \"margin-left: 10px;\">否</td></tr>"
                    console.log(str); 
                }
            }
            $("#tbody1").html(str);
        }


    }

    </script>
    <script>
        //管理员操作
        //设置不能同时选择是和否
        $('input').click(function () {
            var now = this;
            $('input').each(function (i, e) {
                if (now !== e) {
                    $(e).attr('checked', false);
                }
            }) 
        });

        var deny = document.getElementsByName("deny");//获取所有“否”对象
        for (var i = 0; i < deny.length; i++) {
            console.log(deny[i].id);//输出获取到的每个“否”
            deny[i].addEventListener("click", delete_topic);//给每个否绑定delete事件
        }

        var Topic_title = new Array();//声明一个放title的数组

        function delete_topic() {
            var deny_now = this.id;//获取当前被点击的否的id
            // console.log("deny_now" + deny_now);
            // console.log("shuz" + deny_now.substr(deny_now.length - 1, 1))//获取当前被点击的否的编号
            var titleID = " Topic_title" + deny_now.substr(deny_now.length - 1, 1)
            var detailsID = "Topic_details" + deny_now.substr(deny_now.length - 1, 1)
            console.log(titleID, detailsID)
            var titleValue = document.getElementById(titleID).innerText //获取topic_title单元格的值
            console.log(titleValue)
            Topic_title.push(titleValue);//把title放进数组里
            console.log(Topic_title)
        }
        //向后台传输title
        function submit() {
            $.ajax({
                type: "POST",
                url: "http://localhost:8080/Ad_topic_1",
                data: JSON.stringify(titleValue), //将JSON对象转为字符串
                dataType: "JSON",
                contentType: "application/json",
                async: 'true',
                beforeSend: function (XMLHttpRequest, settings) {
                    //ShowLoading();
                    // console.log($.ajax.data);
                },
                success: function () {
                    alert("success");
                },
                error: function () {
                    //请求出错处理
                    console.log("error");
                },
            })
        }


    }












</script>

<body>
    <div class="jumbotron">
        <h1>方正实训</h1>
        <span class="glyphicon glyphicon-bell" style="font-size:20px;"></span><b style="font-size: 20px;">当前位置：<a
                href="main.html" style=" text-decoration:underline">首页</a>/题目发布</b>

        </span>
        <div class="exit">
            <p>退出
                <a href="../../website_tan/html/first.html"><i class="fa fa-arrow-circle-right"
                        style="font-size:30px"></i></a></p>
        </div>
    </div>
    <div class="container">
        <table class="table table-hover table-bordered">
            <thead id = "tbody1">
                <tr>
                    <th>题目名称</th>
                    <th>选题简介</th>
                    <th>提交者</th>
                    <th>是否审核通过</th>
                </tr>
            </thead>
            <tr>
                <td id=" Topic_title1">上机作业管理系统</td>
                <td id="Topic_details1">暂无简介</td>
                <td id="Tutor1">韩延明</td>
                <td><input type="checkbox">是
                    <input type="checkbox" style="margin-left: 10px;" name="deny" id="deny1"">否</td>
            </tr>
            <tr>
                
                <td id=" Topic_title2">数字货币咨询系统</td>
                <td id="Topic_details2">暂无简介</td>
                <td id="Tutor2">韩延明</td>
                <td><input type="checkbox">是
                    <input type="checkbox" style="margin-left: 10px;" name="deny" id="deny2"">否</td>
            </tr>
            <tr>
                <td id=" Topic_title3">上机作业管理系统</td>
                <td id="Topic_details3">暂无简介</td>
                <td id="Tutor3">韩延明</td>
                <td><input type="checkbox">是
                    <input type="checkbox" style="margin-left: 10px;" name="deny" id="deny3"">否</td>
            </tr>
            <tr>
                <td id=" Topic_title4">上机作业管理系统</td>
                <td id="Topic_details4">暂无简介</td>
                <td id="Tutor4">韩延明</td>
                <td><input type="checkbox">是
                    <input type="checkbox" style="margin-left: 10px;" name="deny" id="deny4"">否</td>
            </tr>
            <tr>
                <td id=" Topic_title5">上机作业管理系统</td>
                <td id="Topic_details5">暂无简介</td>
                <td id="Tutor5">韩延明</td>
                <td><input type="checkbox">是
                    <input type="checkbox" style="margin-left: 10px;" name="deny" id="deny5"">否</td>
            </tr>
            <tr>
                <td id=" Topic_title6">上机作业管理系统</td>
                <td id="Topic_details6">暂无简介</td>
                <td id="Tutor6">韩延明</td>
                <td><input type="checkbox">是
                    <input type="checkbox" style="margin-left: 10px;" name="deny" id="deny6"">否</td>
            </tr>
        </table>
        <button type=" button" class="btn btn-primary" style="margin-top: 30px;" onclick="submit()">确认发布</button> </td>
    </div>
</body>